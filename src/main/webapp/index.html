<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>POS Sample App</title>

    <script src="js/node_modules/angular/angular.min.js"></script>

    <script src="js/posSample.js"></script>

    <!-- File upload, from https://github.com/danialfarid/ng-file-upload -->
    <script src="js/node_modules/ng-file-upload/dist/ng-file-upload-shim.js"></script>
    <script src="js/node_modules/ng-file-upload/dist/ng-file-upload.js"></script>
    <link rel="stylesheet" type="text/css" href="css/fileUpload.css"/>

    <link rel="stylesheet" type="text/css" href="css/styles.css"/>
    <link rel="stylesheet" type="text/css" href="css/ordersSidebar.css"/>
    <link rel="stylesheet" type="text/css" href="css/tenderPaymentDialog.css"/>
</head>
<body ng-app="posApp">

<div ng-controller="OrderEntryController">
    <form>
        <h4>Order entry</h4>

        <div>
            <button id="viewOrdersButton"
                    class="smallHorizontalMargin">
                ORDERS
            </button>
        </div>

        <div id="itemsAndSummaryContainer">
            <div id="itemsList">
                <button class="itemButton smallMargin" ng-repeat="item in allItems" ng-click="addItem(item)">
                    {{item.name}}
                </button>
            </div>

            <div id="orderSidebar" class="smallMargin">
                <div>
                    <!-- TODO.  Also, pad order # with zeros -->
                    New Order / Order #099
                </div>

                <!-- The list of items in this order -->
                <div id="orderItemsPanel">
                    <div id="orderItemsList">
                        <div class="totalsPanelRow {{entry.item == selectedItem ? 'selectedRow' : ''}}"
                             style="cursor:pointer;"
                             ng-repeat="(name, entry) in itemsInOrder"
                             ng-click="selectItem(entry.item)">

                            <div class="orderNumber">{{entry.quantity}}</div>
                            <div class="summaryLeftColumn">{{name}}</div>
                            <div class="summaryRightColumn">{{entry.item.price | currency}}</div>
                        </div>
                    </div>
                    <div id="totalsPanel">
                        <div class="totalsPanelRow">
                            <div class="summaryLeftColumn">Subtotal:</div>
                            <div class="summaryRightColumn" ng-bind="getSubtotal() | currency"></div>
                        </div>

                        <div class="totalsPanelRow">
                            <div class="summaryLeftColumn">Sales Tax:</div>
                            <div class="summaryRightColumn" ng-bind="getSalesTax() | currency"></div>
                        </div>

                        <div class="totalsPanelRow">
                            <div class="summaryLeftColumn">Grand Total:</div>
                            <div class="summaryRightColumn" ng-bind="getGrandTotal() | currency"></div>
                        </div>
                    </div>
                </div>

                <div class="smallVerticalMargin">
                    <button id="voidOrderButton"
                            ng-disabled="!selectedItem"
                            ng-click="voidSelectedItem()">
                        VOID
                    </button>
                    <button id="payNowButton"
                            ng-disabled="getSubtotal() == 0"
                            ng-click="isPaying = true">
                        PAY NOW
                    </button>
                </div>
            </div>
        </div>

        <!-- Tender Payment dialog -->
        <div ng-show="isPaying">
            <hr/>

            <table id="paymentDialog" class="centeredTable">
                <tr>
                    <td>
                        <div class="largeMargin">TENDER PAYMENT</div>

                        <table class="centeredTable largeMargin">
                            <tr>
                                <td class="paymentDialogLeftColumn">Amount Due:</td>
                                <td ng-bind="getGrandTotal() | currency"></td>
                            </tr>
                            <tr>
                                <td class="paymentDialogLeftColumn">Amount Tendered:</td>
                                <td>
                                    <input id="txtAmountTendered"
                                           type="text"
                                           ng-model="amountTendered"/>
                                </td>
                            </tr>
                            <tr>
                                <td class="paymentDialogLeftColumn">Change Due:</td>
                                <td ng-bind="getChangeDue() | currency"></td>
                            </tr>
                        </table>

                        <table class="centeredTable largeBottomMargin">
                            <tr>
                                <td>
                                    <button ng-click="cancelPayment()">
                                        CANCEL
                                    </button>
                                </td>
                                <td>
                                    <button ng-disabled="!isPaymentValid()">
                                        TENDER
                                    </button>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>
    </form>
</div>

<hr/>

<div ng-controller="FileUploadController">
    <form>
        <h4>Upload an items .csv file</h4>

        <button type="file" ngf-select="uploadFiles($file, $invalidFiles)"
                accept="image/*" ngf-max-height="1000" ngf-max-size="1MB">
            Select File
        </button>

        <br><br>

        <div style="font:smaller">{{f.name}} {{errFile.name}} {{errFile.$error}} {{errFile.$errorParam}}
      <span class="progress" ng-show="f.progress >= 0">
          <div style="width:{{f.progress}}%"
               ng-bind="f.progress + '%'"></div>
      </span>
        </div>

        {{uploadMessage}}
    </form>
</div>

</body>
</html>